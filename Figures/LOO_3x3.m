%HM = zeros(5,3,3);
%SM = zeros(5,3,3);

HM(:,:,1) = [0.0568	0.092	0.1682
0.1066	0.1648	0.2725
0.1385	0.1948	0.3024
0.1926	0.2767	0.395
0.2118	0.2793	0.3902];

HM(:,:,2) = [0.0722	0.1539	0.1993
0.0892	0.1129	0.1399
0.1199	0.1366	0.1612
0.1435	0.1611	0.1854
0.1744	0.1919	0.2088];

HM(:,:,3) = [0.0382	0.0538	0.075
0.0847	0.1061	0.1362
0.1219	0.1405	0.1672
0.1495	0.1775	0.2039
0.1976	0.2321	0.2526];

HM_sd(:,:,1) = [0.0409	0.0923	0.1432
0.0598	0.1246	0.1859
0.0477	0.0936	0.1433
0.1109	0.224	0.2398
0.1002	0.1553	0.2007];

HM_sd(:,:,2) = [0.0208	0.0443	0.0549
0.016	0.0312	0.0409
0.0238	0.0334	0.0456
0.0247	0.0335	0.0432
0.0291	0.0384	0.0442];

HM_sd(:,:,3) = [0.0159	0.0341	0.0468
0.0231	0.0417	0.0677
0.0541	0.0724	0.0744
0.0412	0.0675	0.0907
0.1208	0.2047	0.1641];

SM(:,:,1) = [0.1611	0.3423	0.6814
0.3307	0.5899	0.9256
0.4592	0.7793	1.0632
0.5857	0.8763	1.1183
0.7739	0.976	1.0885];

SM(:,:,2) = [0.1443	0.2233	0.3188
0.195	0.2635	0.377
0.2406	0.3065	0.4211
0.3009	0.3659	0.4856
0.3366	0.3935	0.4962];

SM(:,:,3) = [0.1243	0.1973	0.2977
0.2	0.3056	0.4622
0.2785	0.408	0.6141
0.3596	0.5047	0.7139
0.4449	0.6059	0.7781];

SM_sd(:,:,1) = [0.0515	0.1116	0.3006
0.2613	0.31	0.2577
0.2475	0.295	0.1959
0.1988	0.1469	0.2632
0.2132	0.182	0.1901];

SM_sd(:,:,2) = [0.0213	0.0327	0.0447
0.0236	0.0355	0.0514
0.031	0.0539	0.0659
0.0794	0.1126	0.1242
0.0429	0.0668	0.0812];

SM_sd(:,:,3) = [0.062	0.0937	0.1418
0.0497	0.1023	0.1101
0.0415	0.0842	0.0988
0.0689	0.091	0.0982
0.0775	0.1564	0.0904];

obs = [0.05,0.1,0.15,0.2,0.25];
obs_shift = obs +0.005;
% Create a new figure window that will contain the subplots
myfig = figure('Color', 'white');


% Create subplots within the new figure window
species = [1,2,5];
for i = 1:3
    for j = 1:3
        subplot(3, 3, (j-1)*3+i);
        %subplot('Position',[0.04+(i-1)/3, 1.025-j/3, 0.28, 0.28]);
        %plot(obs,HM(:,i,j),'-o','MarkerSize',10,'LineWidth',3);
        hold on;
        errorbar(obs,HM(:,i,j),HM_sd(:,i,j),'-o','MarkerSize',10,'LineWidth',2)
        errorbar(obs_shift,SM(:,i,j),SM_sd(:,i,j),'-o','MarkerSize',10,'LineWidth',2)
        %plot(obs,SM(:,i,j),'-o','MarkerSize',10,'LineWidth',3)
        if i == 1
            title(sprintf("%dD", species(j)),"FontSize",20);
        end 
        if j == 1
            title(sprintf("Steps Ahead %d", i),"FontSize",20);
        end 
        if (j == 1 & i == 1)
            title("Steos Ahead 1, 1D")
            legend("HMS-map","S-map","FontSize",20)
        end 

        %title(sprintf("Steps Ahead %d, %dD", i, species(j)),"FontSize",20);
        ax = gca; 
        ax.FontSize = 20; 
        xlabel("Observation Noise","FontSize",20)
        ylabel("MSE","FontSize",20)
        xlim([0.05 0.26])
    end
end
set(findall(myfig, 'Type', 'Text'),'FontWeight', 'Normal')
hold off



